# Практическая работа №5 - Threat Hunting

**Выполнил студент группы ББМО-01-23 Росляков В.А.**

Для выполнения работы был использован стенд, аналогичный стенду из практической работы 3

Всего 3 виртуальные машины
1) Ubuntu с агентом Wazuh
2) Ubuntu с сервером Wazuh
3) Kali Linux

С хоста, с настроенным агентом имеем доступ по сети к хосту с сервером. Видим подключённый агент.

![image](1.png)

# IDS Suricata

Развернем дополнительно на защищаемом хосте IDS Suricata

Добавляем репозитории suricata

![image](2.png)

Устанавливаем

![image](3.png)

Также загружаем правила

![image](4.png)

Модифицируем конфиг

![image](5.png)

Внесем сбор логов сурикаты в конфиг Wazuh

![image](6.png)

Перезапускаем агент

![image](7.png)

После пробуем пропинговать хост с агентом и видим события от сурикаты

![image](8.png)

# Web-приложение

На защищаемом клиенте поднято пустое веб-приложение Apache

![image](9.png)

![image](10.png)

# Сканер уязвимостей Nikto

Запустим сканер уязвимостей Nikto с Kali

![image](11.png)

Также видим события от сурикаты

![image](12.png)

![image](12_2.png)

# YARA

Скачивание, компиляция и установка YARA

![image](13.png)

![image](14.png)

Проверяем, что установка прошла успешно

![image](15.png)

Загружаем правила

![image](16.png)

Создаём скрипт и устанавливаем привилегии в соответствии с документацией

![image](17.png)

Редактируем ossec конфиг

![image](18.png)

На сервере также настраиваем всё необходимое

Настраиваем правила для отслеживания изменений и срабатывания YARA-правил

![image](19.png)

Настраиваем декодер

![image](20.png)

Настраиваем команды для сканирования

![image](21.png)

Срабатывание правил Yara

Для проверки был создан реверс-шелл с помощью msfvenom. После его исполнения на хосте с агентом, получили доступ на кали

![image](22.png)

Также видим срабатывание правил в Wazuh

![image](23.png)